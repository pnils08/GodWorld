# Disaster Recovery — GodWorld

**If the machine dies, this is how you rebuild.**

Last Updated: 2026-02-17 | Session: 39

---

## What Survives Without the Machine

These are already in the cloud. You lose nothing:

| Data | Location | How to Recover |
|------|----------|---------------|
| All code, docs, hooks, skills, agent memory | GitHub (`pnils08/GodWorld`) | `git clone` |
| Simulation data (20+ ledgers) | Google Sheets | Already there — just reconnect |
| Curated knowledge | Supermemory (`sm_project_godworld`) | Search from any Claude instance |
| Published editions | Google Drive (Publications Archive) | Already there |
| Drive archive (614 files) | Google Drive (5 roots) | Already there; re-crawl with `scripts/crawlDrive.js` |
| Mara Vance's memory | Supermemory | Already there; she accesses via claude.ai |

## What You Need to Recreate

### Step 1: Clone the Repo

```bash
cd ~
git clone https://github.com/pnils08/GodWorld.git
cd GodWorld
npm install
```

### Step 2: Restore .env

Create `/root/GodWorld/.env` with these keys:

```
# Anthropic (Claude API)
ANTHROPIC_API_KEY=          # From: https://console.anthropic.com/settings/keys

# Google Sheets (service account)
GOOGLE_SERVICE_ACCOUNT_EMAIL=   # From: Google Cloud Console → IAM → Service Accounts
GOOGLE_PRIVATE_KEY=             # From: service account JSON → private_key field
SPREADSHEET_ID=                 # The main GodWorld spreadsheet ID (from the URL)

# Google Drive OAuth (user credentials for write access)
GOOGLE_CLIENT_ID=               # From: Google Cloud Console → APIs → Credentials → OAuth 2.0
GOOGLE_CLIENT_SECRET=           # Same location
GOOGLE_REFRESH_TOKEN=           # Generated by: node scripts/authorizeDriveWrite.js

# Discord Bot
DISCORD_BOT_TOKEN=              # From: https://discord.com/developers/applications
DISCORD_CHANNEL_ID=             # Right-click channel → Copy Channel ID (dev mode on)
```

**If you have a backup archive:** Extract `.env` from it:
```bash
tar -xzf backups/godworld_backup_YYYY-MM-DD_HHMM.tar.gz -C /tmp root/GodWorld/.env
cp /tmp/root/GodWorld/.env /root/GodWorld/.env
```

### Step 3: Restore Service Account

The service account JSON goes in `credentials/service-account.json`.

**From backup:**
```bash
tar -xzf backups/godworld_backup_YYYY-MM-DD_HHMM.tar.gz -C /tmp root/GodWorld/credentials/
cp -r /tmp/root/GodWorld/credentials/ /root/GodWorld/credentials/
```

**From scratch:** Go to Google Cloud Console → IAM & Admin → Service Accounts → Create key (JSON). Download to `credentials/service-account.json`.

### Step 4: Restore Clasp Auth

```bash
# Option A: From backup
tar -xzf backups/godworld_backup_YYYY-MM-DD_HHMM.tar.gz -C /tmp root/.clasprc.json
cp /tmp/root/.clasprc.json /root/.clasprc.json

# Option B: Fresh login
npx clasp login
```

Also restore `.clasp.json` (contains Apps Script project ID):
```bash
# From backup
tar -xzf backups/godworld_backup_YYYY-MM-DD_HHMM.tar.gz -C /tmp root/GodWorld/.clasp.json
cp /tmp/root/GodWorld/.clasp.json /root/GodWorld/.clasp.json
```

### Step 5: Restore Claude-Mem (Optional)

Claude-Mem is the auto-captured observation database. It enriches sessions but isn't critical — the on-disk files (PERSISTENCE.md, JOURNAL.md, NEWSROOM_MEMORY.md) and Supermemory are the primary memory.

```bash
# From backup
tar -xzf backups/godworld_backup_YYYY-MM-DD_HHMM.tar.gz -C /tmp root/.claude-mem/
cp /tmp/root/.claude-mem/claude-mem.db /root/.claude-mem/claude-mem.db
```

If no backup exists: Claude-Mem will rebuild over time as new sessions run. The hooks auto-capture observations.

### Step 6: Restore Discord Logs (Optional)

```bash
tar -xzf backups/godworld_backup_YYYY-MM-DD_HHMM.tar.gz -C /tmp root/GodWorld/logs/
cp -r /tmp/root/GodWorld/logs/discord-conversations/ /root/GodWorld/logs/discord-conversations/
```

If no backup: logs are nice-to-have. The nightly reflection already journals the highlights.

### Step 6.5: Restore Agent Memory (if needed)

Agent memory (`.claude/agent-memory/`) is version-controlled in git, so it survives a `git clone`. But if the latest updates weren't committed, restore from backup:

```bash
tar -xzf backups/godworld_backup_YYYY-MM-DD_HHMM.tar.gz -C /tmp root/GodWorld/.claude/agent-memory/
cp -r /tmp/root/GodWorld/.claude/agent-memory/ /root/GodWorld/.claude/agent-memory/
```

5 agents have memory: civic-desk, sports-desk, culture-desk, chicago-desk, rhea-morgan. If no backup and git is current, the agents still have their last committed memories. If both are lost, re-seed from `NEWSROOM_MEMORY.md` lessons — the agents will rebuild over editions.

### Step 7: Restart Services

```bash
# Discord bot
cd /root/GodWorld
pm2 start ecosystem.config.js
pm2 save

# Verify cron
crontab -e
# Add if missing:
# 0 14 * * * cd /root/GodWorld && /usr/bin/node scripts/daily-reflection.js >> logs/daily-heartbeat.log 2>&1
# 0 4 * * * cd /root/GodWorld && /usr/bin/node scripts/discord-reflection.js >> logs/discord-reflection.log 2>&1
# 0 5 * * * cd /root/GodWorld && bash scripts/backup.sh >> logs/backup.log 2>&1
```

### Step 8: Re-crawl Drive Archive

```bash
node scripts/crawlDrive.js
```

This rebuilds `output/drive-files/` and `output/drive-manifest.json` from Google Drive.

### Step 9: Rebuild Desk Packets

Run a cycle (or just the packet builder) to regenerate `output/desk-packets/`:

```bash
# In Apps Script editor: runWorldCycle()
# Or just rebuild packets from last cycle's data
```

### Step 10: Verify

```bash
# Check bot
pm2 status

# Check Drive write access
node scripts/saveToDrive.js --test

# Check clasp
npx clasp status

# Start a Claude Code session
# /session-startup should load cleanly
```

---

## Backup Schedule

| Time | What | How |
|------|------|-----|
| 8 AM Central | Morning heartbeat | cron → `daily-reflection.js` |
| All day | Discord bot | PM2 → `mags-discord-bot.js` |
| 10 PM Central | Nightly reflection | cron → `discord-reflection.js` |
| 11 PM Central | Daily backup | cron → `scripts/backup.sh` |

---

## What Cannot Be Recovered

If both the machine AND all backups are lost:

- **Claude-Mem observations** — Gone. Rebuilds over time.
- **Discord conversation logs** — Gone. Nightly reflections captured highlights in JOURNAL.md.
- **Uncommitted agent memory updates** — Gone. Agents rebuild over editions. Commit memory regularly.
- **API keys** — Must be regenerated from respective consoles (Anthropic, Google Cloud, Discord).
- **OAuth refresh token** — Must re-run `node scripts/authorizeDriveWrite.js`.

Everything else survives in GitHub, Google Sheets, Google Drive, or Supermemory.

---

## Quick Recovery Checklist

- [ ] `git clone` from GitHub
- [ ] `npm install`
- [ ] Restore `.env` (from backup or recreate keys)
- [ ] Restore `credentials/service-account.json`
- [ ] Restore `.clasp.json` and `~/.clasprc.json`
- [ ] Restore Claude-Mem DB (if backup exists)
- [ ] `pm2 start ecosystem.config.js && pm2 save`
- [ ] Set up cron jobs (heartbeat, reflection, backup)
- [ ] `node scripts/crawlDrive.js` (re-crawl Drive)
- [ ] `node scripts/saveToDrive.js --test` (verify Drive writes)
- [ ] Verify agent memory exists (`.claude/agent-memory/` — 5 directories)
- [ ] Start Claude Code session, run `/session-startup`
